var paramTypes=new Object();paramTypes.calendar=["format"];paramTypes.category=["class","section","scope"];paramTypes.editors=[];paramTypes.filelist=["directory","filter","exclude","hide_none","hide_default","stripext"];paramTypes.folderlist=["directory","filter","exclude","hide_none","hide_default"];paramTypes.helpsites=[];paramTypes.hidden=["class"];paramTypes.imagelist=["directory","filter","exclude","hide_none","hide_default","stripext"];paramTypes.languages=["client"];paramTypes.list=[];paramTypes.menu=[];paramTypes.menuitem=["state"];paramTypes.password=["class","size"];paramTypes.radio=[];paramTypes.section=[];paramTypes.spacer=[];paramTypes.sql=["query","key_field","value_field"];paramTypes.text=["class","size"];paramTypes.textarea=["rows","cols","class"];paramTypes.timezones=[];paramTypes.usergroup=["class","multiple","size"];if(FBPresent){console.log(paramTypes)}var defaultFields=new Array("label","default","description");var optionalFields=new Array("class","client","cols","directory","exclude","filter","format","hide_none","hide_default","key_field","multiple","query","rows","scope","section","size","state","stripext","value_field");var NL="\n";var jscnt_spacers=0;function addGroup(a){html="<div id='div-group-"+a+"'><h1>"+a+"</h1></div>";$("divParameters").innerHTML+=html;new Element("option",{text:a}).inject($("addParamGroup"))}function newParameter(){ctrlName=$("addParamName").value;ctrlGroup=$("addParamGroup").value;if(ctrlName==""){$("addParamMessage").innerHTML='<div style="color: red;">'+jgettext("You must provide a name")+"</div>";var a=$("addParamMessage").setStyles({display:"block",opacity:0});new Fx.Tween(a,$extend({property:"opacity"}),{duration:1500}).start(1);$("addParamName").focus();div_new_parameter.slideIn();return""}else{attribs={name:""+ctrlName+"",label:"","default":"",description:"",type:"text"};children={};startParam(ctrlGroup,attribs,children);$("addParamMessage").innerHTML="";$("addParamName").value="";div_new_parameter.slideOut()}}function startParam(e,d,c){if(FBPresent){console.log("start...",e,d,c)}tName="div_"+d.name;if(d.type=="spacer"){tName+="spc"+jscnt_spacers;jscnt_spacers++}html="";html+=NL+"<div class='ecr_toggle' id='"+tName+"-toggler' onclick=\"toggleDiv('"+tName+"-slider');\">";html+=NL+"<span id='"+d.name+"-type' style='color: blue;'>"+d.type+"</span>&nbsp:&nbsp;";html+=NL+"<span id='"+tName+"-name'>"+d.name+"</span>";html+=NL+"</div>";html+="<table id='"+tName+"-slider' style='display: none;'><tr><td>";html+="<table style='border: 1px dotted black;'>"+NL;html+="    <tr valign='top'>"+NL;html+="        <td>"+NL;html+="            <table>"+NL;html+="                <tr>"+NL;html+="                    <td>type</td>"+NL;html+="                    <td>";html+=drawTypeSelector(e,d.name,d.type);html+="                        Name";html+=NL+"<input type='text' name='params["+e+"]["+d.name+"][name]' id='namefield_"+d.name+"' value='"+d.name+"' onkeyup=\"$('"+tName+"-name').innerHTML=$('namefield_"+d.name+"').value;\"/>";html+="                    </td>"+NL;html+="                </tr>"+NL;for(var b=0,a=defaultFields.length;b<a;++b){html+="            <tr>"+NL;html+="                <td>"+defaultFields[b]+"</td>"+NL;html+="                <td>"+NL;tValue=(d[defaultFields[b]]==undefined)?"":d[defaultFields[b]];html+="<input type='text' name='params["+e+"]["+d.name+"]["+defaultFields[b]+"]' value='"+tValue+"' />";html+="                </td>"+NL;html+="            </tr>"+NL}for(var b=0,a=optionalFields.length;b<a;++b){html+="            <tr id='"+d.name+"-optional-"+optionalFields[b]+"'>"+NL;html+="                <td>"+optionalFields[b]+"</td>"+NL;html+="                <td>"+NL;tValue=(d[optionalFields[b]]==undefined)?"":d[optionalFields[b]];html+="<input type='text' name='params["+e+"]["+d.name+"]["+optionalFields[b]+"]' value='"+tValue+"' />";html+="                </td>"+NL;html+="            </tr>"+NL}html+="            </table>"+NL;html+="        </td>"+NL;html+="        <td>"+NL;html+="            <table id='"+d.name+"-divOption' style='border: 1px solid blue;'>"+NL;html+="                <tr>";html+="                    <th>Options</th>";html+="                <td class='btn img icon16-add' onclick=\"addOption('"+e+"', '"+d.name+"', '', '');\">";html+="                Add option";html+="                <input type='hidden' name='"+d.name+"-options' id='"+d.name+"-options' value='"+b+"' />";html+="                </td>";html+="                </tr>"+NL;b=0;for(x in c){childName="params["+e+"]["+d.name+"][children]["+b+"]";html+="            <tr>"+NL;html+="                <td>value"+NL;html+="                    <input type='text' name='"+childName+"[value]' id='"+childName+"[value]' value='"+x+"' />";html+="                </td>"+NL;html+="                <td>data"+NL;html+="                    <input type='text' name='"+childName+"[data]' value='"+c[x]+"' />";html+="                </td>"+NL;html+="            </tr>"+NL;b++}if(b>0){b-=1}html+="            </table>"+NL;html+="         </td>"+NL;html+="     </tr>"+NL;html+="</table>"+NL;html+="</td></tr></table>";$("div-group-"+e).innerHTML+=html;switchType(d.name,d.type)}function addOption(d,a,c,b){if(FBPresent){console.log("add option: ",d,a,c,b)}num=parseInt($(a+"-options").value);num+=1;$(a+"-options").value=num;optionName="params["+d+"]["+a+"][children]["+num+"]";html="";html+="            <tr>"+NL;html+="                <td>value"+NL;html+="                    <input type='text' name='"+optionName+"[value]' value='"+c+"' />";html+="                </td>"+NL;html+="                <td>data"+NL;html+="                    <input type='text' name='"+optionName+"[data]' value='"+b+"' />";html+="                </td>"+NL;html+="            </tr>"+NL;$(a+"-divOption").innerHTML+=html}function switchType(a,b){if(FBPresent){console.log("switchType:"+a+"---"+b)}switch(b){case"spacer":fadeOut(a+"-divOption");$("namefield_"+a).value="@spacer";$("namefield_"+a).disabled="disabled";break;case"calendar":case"category":case"editors":case"filelist":case"folderlist":case"helpsites":case"hidden":case"imagelist":case"languages":case"menu":case"menuitem":case"password":case"section":case"sql":case"text":case"textarea":case"timezones":case"usergroup":fadeOut(a+"-divOption");$("namefield_"+a).disabled="";break;case"radio":case"list":fadeIn(a+"-divOption");$("namefield_"+a).disabled="";break;default:if(FBPresent){console.error("UNDEFINED TYPE: "+b)}else{alert("UNDEFINED TYPE: "+b)}return;break}optionalFields.each(function(c){$(a+"-optional-"+c).setStyles({display:"none"})});paramTypes[b].each(function(c){$(a+"-optional-"+c).setStyles({display:"table-row"})});$(a+"-type").innerHTML=b}function fadeIn(a){if(FBPresent){console.log("fadeIn",a)}var b=$(a).setStyles({display:"block"})}function fadeOut(a){if(FBPresent){console.log("fadeOut",a)}var b=$(a);b.setStyles({display:"none"})}function drawTypeSelector(d,a,b){html="";js=" onchange='switchType(\""+a+"\", this.value);'";html+=NL+"<select name='params["+d+"]["+a+"][type]'"+js+">";for(var c in paramTypes){sSelected="";if(c==b){sSelected=" selected='selected'"}html+="<option"+sSelected+">"+c+"</option>"}html+="</select>";return html}function drawLine(a,b,f,h,i){var c=document.getElementById("divParameters");var d=document.getElementById("totalParameters");var g=(document.getElementById("totalParameters").value-1)+2;d.value=g;var e="my"+g+"Div";var j=document.createElement("tr");j.setAttribute("id",e);if(f==""){name="params["+b+glueChar+h+"]"}else{name="params["+b+glueChar+h+"]["+f+"]"}insertText="";insertText+="<td>"+h+"</td>";insertText+='<td><input type="text" name="'+name+'" value="'+i+'" /></td>';j.innerHTML=insertText;c.appendChild(j)}function removeElement(e,b){var c=document.getElementById(b);var a=document.getElementById(e);c.removeChild(a)}function xxremoveElement(a,c){var e=document.getElementById(c);var b=document.getElementById(a);e.removeChild(b)};