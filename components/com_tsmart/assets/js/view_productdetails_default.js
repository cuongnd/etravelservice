//huong dan su dung/* $('.view_productdetails_default').view_productdetails_default(); view_productdetails_default=$('.view_productdetails_default').data('view_productdetails_default'); console.log(view_productdetails_default); */// jQuery Plugin for SprFlat admin view_productdetails_default// Control options and basic function of view_productdetails_default// version 1.0, 28.02.2013// by SuggeElson www.suggeelson.com(function ($) {    // here we go!    $.view_productdetails_default = function (element, options) {        // plugin's default options        var defaults = {            //main color scheme for view_productdetails_default            //be sure to be same as colors on main.css or custom-variables.less            list_group_size: [],            config_show_price: {                mDec: 1,                aSep: ' ',                aSign: 'US$'            },            option_dreymodal : {                minWidth: 250,                maxWidth: 250,                overlay: true,                overlayColor: "#222222",                overlayOpacity: 0.9,                closeButton: true,                inAnimationTime: 600,                inAnimationType: "slideInFromLeft",                outAnimationTime: 600,                outAnimationType: "slideOutToRight",                allowEscapeKey: true,                title: "Alert",                titleBackColor: "#128a4b",                overlayBlur: false,                append: false            },            product:{}        }        // current instance of the object        var plugin = this;        // this will hold the merged default, and user-provided options        plugin.settings = {}        var $element = $(element), // reference to the jQuery version of DOM element            element = element;    // reference to the actual DOM element        // the "constructor" method that gets called when the object is created        plugin.init = function () {            plugin.settings = $.extend({}, defaults, options);            $element.find("#tabbed-nav").zozoTabs({                theme: "silver",                orientation: "horizontal",                position: "top-left",                size: "medium",                animation: {                    easing: "easeInOutExpo",                    duration: 400,                    effects: "slideH"                },                defaultTab: "tab1"            });            $element.find('.table-trip .body .item  .body-item').on('hidden.bs.collapse', function () {                // do something…                var $item = $(this).closest('.row.item');                $item.removeClass('in');            });            $element.find('.table-trip .body .item  .body-item').on('shown.bs.collapse', function () {                // do something…                var $item = $(this).closest('.row.item');                $item.addClass('in');            });            $element.find('span.price').autoNumeric('init',plugin.settings.config_show_price);            $element.find('button.book-now').click(function () {                var $item = $(this).closest('.item');                var tsmart_price_id = $item.data('tsmart_price_id');                var $form = $element.find('form#tour_price');                $form.find('input[name="tsmart_price_id"]').val(tsmart_price_id);                $form.find('input[name="task"]').val('book_now');                var booking_date = $('input[name="filter_start_date"]').val();                $form.find('input[name="booking_date"]').val(booking_date);                $form.submit();                console.log($form);            });            plugin.settings.departure_date_select = new Dreymodal(document.getElementsByClassName('modal-departure-date-select'), {                minWidth: 250,                maxWidth: 250,                overlay: true,                overlayColor: "#222222",                overlayOpacity: 0.9,                closeButton: true,                inAnimationTime: 600,                inAnimationType: "slideInFromLeft",                outAnimationTime: 600,                outAnimationType: "slideOutToRight",                allowEscapeKey: true,                title: "Please select date and click go first",                titleBackColor: "#128a4b",                overlayBlur: false,                append: true,                event_after_show_modal:function(){                    var $modal_form = $('form#modal_tour_price');                    $modal_form.submit(function () {                        var $modal_tour_price=$('form#modal_tour_price');                        var $filter_total_passenger_from_12_years_old = $modal_tour_price.find('#select_number_passenger_modal_filter_total_passenger_from_12_years_old').data('html_select_number_passenger');                        var total_passenger_from_12_years_old= $filter_total_passenger_from_12_years_old.get_value();                        var $filter_total_passenger_under_12_years_old = $modal_tour_price.find('#select_number_passenger_modal_filter_total_passenger_under_12_years_old').data('html_select_number_passenger');                        var total_passenger_under_12_years_old= $filter_total_passenger_under_12_years_old.get_value();                        var $select_date_modal_filter_start_date = $modal_tour_price.find('#select_date_modal_filter_start_date').data('html_select_date');                        var date_select=$select_date_modal_filter_start_date.get_value();                        var product=plugin.settings.product;                        var now=moment().add(product.tour_booking_before_days,'days');                        if(total_passenger_from_12_years_old==null){                            var alert_drey_modal = new Dreymodal('<div>please selected total passenger</div>',{                                title:"Messenger",                                titleBackColor: "#bc056d",                                event_after_close:function(){                                    console.log(date_select);                                }                            });                            alert_drey_modal.open();                            return false;                        }else if(total_passenger_under_12_years_old>total_passenger_from_12_years_old*2){                            var option_dreymodal= plugin.settings.option_dreymodal;                            option_dreymodal.title = "Error";                            option_dreymodal.titleBackColor = "#bc056d";                            var alert_drey_modal = new Dreymodal('<div>Total passenger under 12 years old must be less than double total passenger from 12 years old</div>',option_dreymodal);                            alert_drey_modal.open();                            return false;                        }else  if(date_select==''){                            var alert_drey_modal = new Dreymodal('<div>please selected date</div>',{                                title:"Messenger",                                titleBackColor: "#bc056d",                                event_after_close:function(){                                    $select_date_modal_filter_start_date.focus();                                    console.log(date_select);                                }                            });                            alert_drey_modal.open();                            return false;                        }else if(!now.isSameOrBefore(date_select)){                            var option_dreymodal= plugin.settings.option_dreymodal;                            option_dreymodal.title = "Error";                            option_dreymodal.titleBackColor = "#bc056d";                            var alert_drey_modal = new Dreymodal('<div>Booking date must be greater than '+product.tour_booking_before_days+'(days) </div>',option_dreymodal);                            alert_drey_modal.open();                            return false;                        }                        return true;                    });                }            });            $element.find('.required-select-date').click(function () {                plugin.settings.departure_date_select.open();                $('#select_date_picker_modal-filter_start_date').focus();            });            $element.find('.btn-clear button').click(function () {                $('select[name="filter_total_passenger_from_12_years_old"]').val('').rules('remove');                $('select[name="filter_total_passenger_under_12_years_old"]').val('').rules('remove');                $('input[name="filter_start_date"]').val('');            });            var $filter_total_passenger_from_12_years_old = $element.find('#select_number_passenger_filter_total_passenger_from_12_years_old').data('html_select_number_passenger');            var list_group_size = plugin.settings.list_group_size;            // sort by value            list_group_size.sort(function (a, b) {                return a.from - b.from;            });            plugin.settings.list_group_size=list_group_size;            var list_string_group_size=[];            for (var i = 0; i < list_group_size.length; i++) {                var group_size = list_group_size[i];                list_string_group_size.push("("+group_size.from+" to "+group_size.to+")");            }            plugin.settings.list_string_group_size=list_string_group_size;            $filter_total_passenger_from_12_years_old.settings.onchange = function (total_passenger) {                console.log(total_passenger);                var list_group_size = plugin.settings.list_group_size;                var in_group = false;                for (var i = 0; i < list_group_size.length; i++) {                    var group_size = list_group_size[i];                    if (total_passenger >= parseInt(group_size.from) && total_passenger <= parseInt(group_size.to)) {                        in_group = true;                        break;                    }                }                if (!in_group) {                    var option = {                        minWidth: 250,                        maxWidth: 250,                        overlay: true,                        overlayColor: "#222222",                        overlayOpacity: 0.9,                        closeButton: true,                        inAnimationTime: 600,                        inAnimationType: "slideInFromLeft",                        outAnimationTime: 600,                        outAnimationType: "slideOutToRight",                        allowEscapeKey: true,                        title: "Error",                        titleBackColor: "#bc056d",                        overlayBlur: false,                        append: false                    };                    var alert_drey_modal = new Dreymodal('<div><h3>your selected not suport,this tour only suport group:</h3>'+plugin.settings.list_string_group_size.join(',')+'<br/>please select an other</div>', option);                    alert_drey_modal.open();                    var first_group_size= plugin.settings.list_group_size[0];                    $filter_total_passenger_from_12_years_old.set_value(first_group_size.from);                }            };            var $form = $element.find('form#filter_tour_price');            $form.submit(function () {                var $filter_total_passenger_from_12_years_old = $element.find('#select_number_passenger_filter_total_passenger_from_12_years_old').data('html_select_number_passenger');                var int_filter_total_passenger_from_12_years_old=$filter_total_passenger_from_12_years_old.get_value();                var total_passenger_from_12_years_old= $filter_total_passenger_from_12_years_old.get_value();                var $filter_total_passenger_under_12_years_old = $element.find('#select_number_passenger_filter_total_passenger_under_12_years_old').data('html_select_number_passenger');                var total_passenger_under_12_years_old= $filter_total_passenger_under_12_years_old.get_value();                var $select_date_filter_start_date = $element.find('#select_date_filter_start_date').data('html_select_date');                var date_select=$select_date_filter_start_date.get_value();                var product=plugin.settings.product;                var now=moment().add(product.tour_booking_before_days,'days');                if(int_filter_total_passenger_from_12_years_old==null){                    var alert_drey_modal = new Dreymodal('<div>please selected total passenger</div>',{                        title:"Messenger",                        titleBackColor: "#bc056d",                        event_after_close:function(){                            console.log(date_select);                        }                    });                    alert_drey_modal.open();                    return false;                }else if(total_passenger_under_12_years_old>total_passenger_from_12_years_old*2){                    var option_dreymodal= plugin.settings.option_dreymodal;                    option_dreymodal.title = "Error";                    option_dreymodal.titleBackColor = "#bc056d";                    var alert_drey_modal = new Dreymodal('<div>Total passenger under 12 years old must be less than double total passenger from 12 years old</div>',option_dreymodal);                    alert_drey_modal.open();                    return false;                }else  if(date_select==''){                    var alert_drey_modal = new Dreymodal('<div>please selected date</div>',{                        title:"Messenger",                        titleBackColor: "#bc056d",                        event_after_close:function(){                            $select_date_filter_start_date.focus();                            console.log(date_select);                        }                    });                    alert_drey_modal.open();                    return false;                }else if(!now.isSameOrBefore(date_select)){                    var option_dreymodal= plugin.settings.option_dreymodal;                    option_dreymodal.title = "Error";                    option_dreymodal.titleBackColor = "#bc056d";                    var alert_drey_modal = new Dreymodal('<div>Booking date must be greater than '+product.tour_booking_before_days+'(days) </div>',option_dreymodal);                    alert_drey_modal.open();                    return false;                }                return true;            });        };        plugin.example_function = function () {        }        plugin.init();    }    // add the plugin to the jQuery.fn object    $.fn.view_productdetails_default = function (options) {        // iterate through the DOM elements we are attaching the plugin to        return this.each(function () {            // if plugin has not already been attached to the element            if (undefined == $(this).data('view_productdetails_default')) {                var plugin = new $.view_productdetails_default(this, options);                $(this).data('view_productdetails_default', plugin);            }        });    }})(jQuery);